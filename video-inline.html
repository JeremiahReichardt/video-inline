<!--
`video-inline` is a reusable component that extends the video element to play videos inline
and autoplay video on mobile/iOS, rather than going full screen and no autoplay.

Example:
    `<video is="video-inline" autoplay="true" src="foo.webm"></video>`

@element video-inline
@demo demo/index.html
-->

<dom-module id="video-inline">
    <template>
        <style>
            canvas{
                display: none;
            }
        </style>
        <video id="video"
               autoplay="{{autoplay}}"
               controls="{{controls}}"
               height="{{height}}"
               loop="{{loop}}"
               muted="{{muted}}"
               poster="{{poster}}"
               preload="{{preload}}"
               src="{{src}}"
               width="width">
        </video>
        <canvas></canvas>
    </template>
    <script>
        Polymer({
            is: 'video-inline',

            currentTime:-1,

            _updateCurrentTime:function(){
                this.currentTime = this.$$('video').currentTime;
            },

            listeners: {
                'video.timeupdate' : '_updateCurrentTime'
            },

            ready: function(){
                var v = this.$$('video');

                console.log( v );

                v.onabort = function(){
                    this.fire('abort');
                }.bind(this);

                v.oncanplay = function(){
                    this.fire('canplay');
                }.bind(this);

                v.oncanplaythrough = function(){
                    this.fire('canplaythrough');
                }.bind(this);

                v.ondurationchange = function(){
                    this.fire('durationchange');
                }.bind(this);

                v.onemptied = function(){
                    this.fire('emptied');
                }.bind(this);

                v.onended = function(){
                    this.fire('ended');
                }.bind(this);

                v.onerror = function(){
                    this.fire('error');
                }.bind(this);

                v.onloadeddata = function(){
                    this.fire('loadeddata');
                }.bind(this);

                v.onloadedmetadata = function(){
                    this.fire('loadedmetadata');
                }.bind(this);

                v.onloadstart = function(){
                    this.fire('loadstart');
                }.bind(this);

                v.onpause = function(){
                    this.fire('pause');
                }.bind(this);

                v.onplay = function(){
                    this.fire('play');
                }.bind(this);

                v.onplaying = function(){
                    this.fire('playing');
                }.bind(this);

                v.onprogress = function(){
                    this.fire('progress');
                }.bind(this);

                v.onratechange = function(){
                    this.fire('ratechange');
                }.bind(this);

                v.onseeked = function(){
                    this.fire('seeked');
                }.bind(this);

                v.onseeking = function(){
                    this.fire('seeking');
                }.bind(this);

                v.onstalled = function(){
                    this.fire('stalled');
                }.bind(this);

                v.onsuspend = function(){
                    this.fire('suspend');
                }.bind(this);

                v.ontimeupdate = function(){
                    this.fire('timeupdate');
                }.bind(this);

                v.onvolumechange = function(){
                    this.fire('volumechange');
                }.bind(this);

                v.onwaiting = function(){
                    this.fire('waiting');
                }.bind(this);
            },

            properties:{

                /**Specifies that the video will start playing as soon as it is ready*/
                autoplay:{
                    type:Boolean
                },

                /**Specifies that video controls should be displayed (such as a play/pause button etc).*/
                controls:{
                    type:Boolean
                },

                /**Sets the height of the video player*/
                height:{
                    type:Number
                },

                /**Specifies that the video will start over again, every time it is finished*/
                loop:{
                    type:Boolean
                },

                /**Specifies that the audio output of the video should be muted*/
                muted:{
                    type:Boolean
                },

                /**Specifies an image to be shown while the video is downloading, or until the user hits the play button*/
                poster:{
                    type:String
                },

                /**Specifies if and how the author thinks the video should be loaded when the page loads
                 * 'auto'
                 * 'metadata'
                 * 'none'
                 * */
                preload:{
                    type:String
                },

                /** Sets the width of the video player */
                width:{
                    type:String
                }
            },

            addTextTrack: function(src){
                return this.$$('video').addTextTrack(src);
            },

            canPlayType: function(src){
                return this.$$('video').canPlayType(src);
            },

            load: function(){
                this.$$('video').load();
            },

            play: function(){
                this.$$('video').play();
            },

            pause: function(){
                this.$$('video').pause();
            }
        });
    </script>
</dom-module>